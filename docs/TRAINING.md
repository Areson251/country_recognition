```
python -m countrydet.main train --root dataset/train_val --epochs 10 --batch_size 2 --image_size 224 --lr 1e-4
```


Причина, почему в описанном пайплайне фигурирует только CLIPScorer, а нет отдельного OCRCountryScorer, в том что:

    CLIPScorer (OCR-free ветка) даёт «универсальное» семантическое представление документа: он смотрит на картинку целиком, извлекает визуальные и текстовые паттерны (например, шрифт, расположение зон документа, цветовые схемы, флаги, эмблемы). Это позволяет делать zero-shot или few-shot классификацию через текстовые промпты вроде "Passport of Germany" без жёсткой привязки к OCR.

    OCR-вход тоже критически важен, но у него нет смысла делать отдельный OCRCountryScorer, потому что OCR — это не «скалярная метрика похожести», а источник признаков. После OCR текст проходит через языковую модель или текстовый энкодер (например, MiniLM / LaBSE / mBERT), и эти признаки уже сливаются с CLIP-эмбеддингами.
    ⬅ То есть OCR играет роль feature extractor, а не scoring-модуля.

    Фьюжн делается в classifier head, где на вход поступает конкатенация двух эмбеддингов ([CLIP_embedding ; OCR_embedding]) → далее Multi-Layer Perceptron → softmax по странам.

